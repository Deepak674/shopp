var Pricelines=new Pricelines,productOptions=new Array,optionMenus=new Array,detailsidx=1,variationsidx=1,optionsidx=1,pricingidx=1,pricelevelsidx=1,fileUploader=!1,changes=!1,saving=!1,template=!0;jQuery(document).ready(function(){function e(e){var i=t("#pricerange-menu"),n=pricelevelsidx++,a=new NestedMenu(n,i,"priceranges","",e,!1,{axis:"y",scroll:!1});t(a.label).change(function(){this.value=asMoney(this.value)}).change()}function i(e){var i=t("#details-menu"),n=t("#details-list"),a=t("#addDetailOption"),s=detailsidx,o=new NestedMenu(s,i,"specs",NEW_DETAIL_DEFAULT,e,{target:n,type:"list"});o.items=new Array,o.addOption=function(e){var i=new NestedMenuOption(o.index,o.itemsElement,o.dataname,NEW_OPTION_DEFAULT,e,!0);o.items.push(i)};var c=t('<li class="setting"></li>').appendTo(o.itemsElement),l=t('<select name="specs['+o.index+'][facetedmenu]"></select>').appendTo(c);t('<option value="disabled">'+FACETED_DISABLED+"</option>").appendTo(l),t('<option value="auto">'+FACETED_AUTO+"</option>").appendTo(l),t('<option value="ranges">'+FACETED_RANGES+"</option>").appendTo(l),t('<option value="custom">'+FACETED_CUSTOM+"</option>").appendTo(l),e&&e.facetedmenu&&l.val(e.facetedmenu),l.change(function(){"disabled"==t(this).val()||"auto"==t(this).val()?(t(a).hide(),t(o.itemsElement).find("li.option").hide()):(t(a).show(),t(o.itemsElement).find("li.option").show())}).change(),e&&e.options&&t.each(e.options,function(e,i){o.addOption(i)}),t(o.itemsElement).sortable({axis:"y",items:"li.option",scroll:!1}),o.element.unbind("click",o.click),o.element.click(function(){o.selected(),t(a).unbind("click").click(o.addOption),t(l).change()}),detailsidx++}var t=jQuery;new SlugEditor(category,"category"),new ImageUploads(t("#image-category-id").val(),"category");postboxes.add_postbox_toggles("shopp_page_shopp-categories"),t(".if-js-closed").removeClass("if-js-closed").addClass("closed"),t(".postbox a.help").click(function(){return t(this).colorbox({iframe:!0,open:!0,innerWidth:768,innerHeight:480,scrolling:!1}),!1}),t("#category").submit(function(){return this.action=this.action.substr(0,this.action.indexOf("?"))+"?"+t.param(request),!0}),t("#templates, #details-template, #details-facetedmenu, #variations-template, #variations-pricing, #price-ranges").hide(),t("#spectemplates-setting").change(function(){this.checked?t("#templates, #details-template").show():t("#details-template").hide(),t("#spectemplates-setting").attr("checked")||t("#variations-setting").attr("checked")||t("#templates").hide()}).change(),t("#faceted-setting").change(function(){this.checked?(t("#details-menu").removeClass("options").addClass("menu"),t("#details-facetedmenu, #price-ranges").show()):(t("#details-menu").removeClass("menu").addClass("options"),t("#details-facetedmenu, #price-ranges").hide())}).change(),details&&t.each(details,function(e,t){i(t)}),t("#addPriceLevel").click(function(){e()}),t("#addDetail").click(function(){i()}),t("#variations-setting").bind("toggleui",function(){this.checked?t("#templates, #variations-template, #variations-pricing").show():t("#variations-template, #variations-pricing").hide(),t("#spectemplates-setting").attr("checked")||t("#variations-setting").attr("checked")||t("#templates").hide()}).click(function(){t(this).trigger("toggleui")}).trigger("toggleui"),options&&loadVariations(options.v?options.v:options,prices),t("#addVariationMenu").click(function(){addVariationOptionsMenu()}),t("#pricerange-facetedmenu").change(function(){"custom"==t(this).val()?t("#pricerange-menu, #addPriceLevel").show():t("#pricerange-menu, #addPriceLevel").hide()}).change(),priceranges&&t.each(priceranges,function(i,t){e(t)}),category||t("#title").focus()});